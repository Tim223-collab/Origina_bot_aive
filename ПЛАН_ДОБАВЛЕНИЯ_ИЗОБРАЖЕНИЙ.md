# üì∏ –ü–ª–∞–Ω –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

## üéØ –¶–µ–ª—å
–î–æ–±–∞–≤–∏—Ç—å –∞–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ **Google Gemini 1.5 Flash**

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- ‚úÖ **–ë–ï–°–ü–õ–ê–¢–ù–û** (1500 –∑–∞–ø—Ä–æ—Å–æ–≤/–¥–µ–Ω—å)
- ‚úÖ –û—Ç–ª–∏—á–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ
- ‚úÖ OCR, –æ–ø–∏—Å–∞–Ω–∏–µ, –∞–Ω–∞–ª–∏–∑
- ‚úÖ –ë—ã—Å—Ç—Ä–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (1-2 —á–∞—Å–∞)

---

## üìã –ß—Ç–æ –ø–æ–ª—É—á–∏–º

### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
1. **–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**
   ```
   –¢—ã: [—Ñ–æ—Ç–æ –∑–∞–∫–∞—Ç–∞]
   –ë–æ—Ç: –ù–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω –∫—Ä–∞—Å–∏–≤—ã–π –∑–∞–∫–∞—Ç –Ω–∞–¥ –º–æ—Ä–µ–º...
   ```

2. **OCR (—Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞)**
   ```
   –¢—ã: [—Ñ–æ—Ç–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞]
   –ë–æ—Ç: üìÑ –†–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç:
        "–î–æ–≥–æ–≤–æ—Ä ‚Ññ12345..."
        
        ‚úÖ –°–æ–∑–¥–∞—Ç—å –∑–∞–º–µ—Ç–∫—É?
   ```

3. **–ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞**
   ```
   –¢—ã: [—Å–∫—Ä–∏–Ω—à–æ—Ç –∫–æ–¥–∞] "–ù–∞–π–¥–∏ –æ—à–∏–±–∫—É"
   –ë–æ—Ç: –í–∏–∂—É –ø—Ä–æ–±–ª–µ–º—É –≤ —Å—Ç—Ä–æ–∫–µ 5:
        "varible" ‚Üí –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "variable"
   ```

4. **–û—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –ø–æ —Ñ–æ—Ç–æ**
   ```
   –¢—ã: [—Ñ–æ—Ç–æ –≥—Ä–∞—Ñ–∏–∫–∞] "–ö–∞–∫–æ–π —Ç—Ä–µ–Ω–¥?"
   –ë–æ—Ç: –ì—Ä–∞—Ñ–∏–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–æ—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–µ–Ω–¥...
   ```

---

## üîß –ü–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

### –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç—å API –∫–ª—é—á (5 –º–∏–Ω—É—Ç)

1. –û—Ç–∫—Ä–æ–π: https://makersuite.google.com/app/apikey
2. –í–æ–π–¥–∏ –ø–æ–¥ Google –∞–∫–∫–∞—É–Ω—Ç–æ–º
3. –ù–∞–∂–º–∏ "Create API Key"
4. –°–∫–æ–ø–∏—Ä—É–π –∫–ª—é—á

### –®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å –≤ .env (1 –º–∏–Ω—É—Ç–∞)

–û—Ç–∫—Ä–æ–π `.env` –∏ –¥–æ–±–∞–≤—å:
```env
# Google Gemini –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
GEMINI_API_KEY=—Ç–≤–æ–π_–∫–ª—é—á_–∑–¥–µ—Å—å
```

### –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (2 –º–∏–Ω—É—Ç—ã)

```bash
pip install google-generativeai pillow
```

### –®–∞–≥ 4: –°–æ–∑–¥–∞—Ç—å VisionService (15 –º–∏–Ω—É—Ç)

–°–æ–∑–¥–∞–π —Ñ–∞–π–ª `services/vision_service.py`:

```python
"""
–°–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ —á–µ—Ä–µ–∑ Google Gemini
"""
import google.generativeai as genai
from PIL import Image
import io
import os
from typing import Optional


class VisionService:
    """
    –ê–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ Google Gemini 1.5 Flash
    """
    
    def __init__(self, api_key: str = None):
        self.api_key = api_key or os.getenv("GEMINI_API_KEY")
        
        if self.api_key:
            genai.configure(api_key=self.api_key)
            self.model = genai.GenerativeModel('gemini-1.5-flash')
        else:
            print("‚ö†Ô∏è GEMINI_API_KEY –Ω–µ –Ω–∞–π–¥–µ–Ω")
            self.model = None
    
    async def analyze_image(self, 
                           image_bytes: bytes, 
                           question: str = None,
                           language: str = "ru") -> Optional[str]:
        """
        –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
        
        Args:
            image_bytes: –ë–∞–π—Ç—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            question: –í–æ–ø—Ä–æ—Å –ø–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
            language: –Ø–∑—ã–∫ –æ—Ç–≤–µ—Ç–∞ (ru/uk/en)
            
        Returns:
            –û—Ç–≤–µ—Ç –æ—Ç –º–æ–¥–µ–ª–∏
        """
        if not self.model:
            return "‚ùå Gemini API –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –î–æ–±–∞–≤—å GEMINI_API_KEY –≤ .env"
        
        try:
            # –û—Ç–∫—Ä—ã–≤–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            image = Image.open(io.BytesIO(image_bytes))
            
            # –§–æ—Ä–º–∏—Ä—É–µ–º –ø—Ä–æ–º–ø—Ç
            if question:
                prompt = question
            else:
                if language == "ru":
                    prompt = "–û–ø–∏—à–∏ –ø–æ–¥—Ä–æ–±–Ω–æ —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–æ –Ω–∞ —ç—Ç–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–µ"
                elif language == "uk":
                    prompt = "–û–ø–∏—à–∏ –¥–µ—Ç–∞–ª—å–Ω–æ —â–æ –∑–æ–±—Ä–∞–∂–µ–Ω–æ –Ω–∞ —Ü—ñ–π –∫–∞—Ä—Ç–∏–Ω—Ü—ñ"
                else:
                    prompt = "Describe in detail what is shown in this image"
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å
            response = self.model.generate_content([prompt, image])
            
            return response.text
            
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: {e}")
            return f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: {str(e)}"
    
    async def ocr_image(self, image_bytes: bytes) -> Optional[str]:
        """
        –†–∞—Å–ø–æ–∑–Ω–∞–µ—Ç —Ç–µ–∫—Å—Ç –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ (OCR)
        
        Args:
            image_bytes: –ë–∞–π—Ç—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            
        Returns:
            –†–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
        """
        if not self.model:
            return "‚ùå Gemini API –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω"
        
        try:
            image = Image.open(io.BytesIO(image_bytes))
            
            prompt = """–†–∞—Å–ø–æ–∑–Ω–∞–π –≤–µ—Å—å —Ç–µ–∫—Å—Ç –Ω–∞ —ç—Ç–æ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏.
–í–µ—Ä–Ω–∏ —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç, –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤.
–°–æ—Ö—Ä–∞–Ω–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É."""
            
            response = self.model.generate_content([prompt, image])
            
            return response.text
            
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ OCR: {e}")
            return f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–∏ —Ç–µ–∫—Å—Ç–∞: {str(e)}"
    
    async def analyze_code(self, image_bytes: bytes) -> Optional[str]:
        """
        –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–æ–¥ –Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–µ
        
        Args:
            image_bytes: –ë–∞–π—Ç—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            
        Returns:
            –ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞
        """
        if not self.model:
            return "‚ùå Gemini API –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω"
        
        try:
            image = Image.open(io.BytesIO(image_bytes))
            
            prompt = """–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –∫–æ–¥ –Ω–∞ —ç—Ç–æ–º —Å–∫—Ä–∏–Ω—à–æ—Ç–µ:
1. –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ—Ç –∫–æ–¥?
2. –ï—Å—Ç—å –ª–∏ –æ—à–∏–±–∫–∏ –∏–ª–∏ –æ–ø–µ—á–∞—Ç–∫–∏?
3. –ú–æ–∂–Ω–æ –ª–∏ —É–ª—É—á—à–∏—Ç—å?
4. –ö–∞–∫–∏–µ best practices –Ω–µ —Å–æ–±–ª—é–¥–µ–Ω—ã?

–û—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ."""
            
            response = self.model.generate_content([prompt, image])
            
            return response.text
            
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞: {e}")
            return f"‚ùå –û—à–∏–±–∫–∞: {str(e)}"
```

### –®–∞–≥ 5: –°–æ–∑–¥–∞—Ç—å ImageHandler (15 –º–∏–Ω—É—Ç)

–°–æ–∑–¥–∞–π —Ñ–∞–π–ª `handlers/image_handler.py`:

```python
"""
–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
"""
from telegram import Update
from telegram.ext import ContextTypes
from telegram.constants import ChatAction

from services.vision_service import VisionService


class ImageHandler:
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π"""
    
    def __init__(self, vision_service: VisionService):
        self.vision = vision_service
    
    async def handle_photo(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """
        –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ñ–æ—Ç–æ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        """
        # –ü–æ–ª—É—á–∞–µ–º —Å–∞–º–æ–µ –±–æ–ª—å—à–æ–µ —Ñ–æ—Ç–æ
        photo = update.message.photo[-1]
        
        # –ü–æ–ª—É—á–∞–µ–º –ø–æ–¥–ø–∏—Å—å (–µ—Å–ª–∏ –µ—Å—Ç—å)
        caption = update.message.caption
        
        await update.message.reply_text("üîç –ê–Ω–∞–ª–∏–∑–∏—Ä—É—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ...")
        await update.message.chat.send_action(ChatAction.TYPING)
        
        try:
            # –°–∫–∞—á–∏–≤–∞–µ–º —Ñ–æ—Ç–æ
            file = await context.bot.get_file(photo.file_id)
            image_bytes = await file.download_as_bytearray()
            
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —á—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å
            if caption and any(word in caption.lower() for word in ['—Ç–µ–∫—Å—Ç', 'ocr', '—Ä–∞—Å–ø–æ–∑–Ω–∞–π', '–ø—Ä–æ—á–∏—Ç–∞–π']):
                # OCR
                result = await self.vision.ocr_image(bytes(image_bytes))
                response = f"üìÑ **–†–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç:**\n\n{result}"
            
            elif caption and any(word in caption.lower() for word in ['–∫–æ–¥', 'code', '–æ—à–∏–±–∫–∞', 'bug']):
                # –ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞
                result = await self.vision.analyze_code(bytes(image_bytes))
                response = f"üíª **–ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞:**\n\n{result}"
            
            else:
                # –û–±—ã—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑
                result = await self.vision.analyze_image(
                    bytes(image_bytes),
                    question=caption
                )
                response = f"üì∏ **–ê–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:**\n\n{result}"
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Ç–≤–µ—Ç
            # –†–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ —á–∞—Å—Ç–∏ –µ—Å–ª–∏ –¥–ª–∏–Ω–Ω—ã–π
            if len(response) > 4000:
                parts = [response[i:i+4000] for i in range(0, len(response), 4000)]
                for part in parts:
                    await update.message.reply_text(part, parse_mode='Markdown')
            else:
                await update.message.reply_text(response, parse_mode='Markdown')
            
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–æ—Ç–æ: {e}")
            await update.message.reply_text(
                f"üòî –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: {str(e)}"
            )
    
    async def ocr_command(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """
        /ocr - —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å —Ç–µ–∫—Å—Ç –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–º —Ñ–æ—Ç–æ
        """
        await update.message.reply_text(
            "üìÑ **OCR (—Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞)**\n\n"
            "–û—Ç–ø—Ä–∞–≤—å —Ñ–æ—Ç–æ —Å —Ç–µ–∫—Å—Ç–æ–º –∏ –ø–æ–¥–ø–∏—à—å '—Ç–µ–∫—Å—Ç' –∏–ª–∏ 'ocr'\n"
            "–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π –∫–æ–º–∞–Ω–¥—É /ocr –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ç–æ",
            parse_mode='Markdown'
        )
    
    async def describe_command(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """
        /describe - –æ–ø–∏—Å–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Ñ–æ—Ç–æ
        """
        await update.message.reply_text(
            "üì∏ **–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**\n\n"
            "–ü—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤—å —Ñ–æ—Ç–æ, –∏ —è –æ–ø–∏—à—É —á—Ç–æ –Ω–∞ –Ω–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–æ!\n"
            "–ò–ª–∏ –¥–æ–±–∞–≤—å –ø–æ–¥–ø–∏—Å—å —Å –≤–æ–ø—Ä–æ—Å–æ–º:\n"
            "‚Ä¢ '–ß—Ç–æ —ç—Ç–æ?'\n"
            "‚Ä¢ '–ö–∞–∫–æ–π —Ü–≤–µ—Ç?'\n"
            "‚Ä¢ '–ù–∞–π–¥–∏ –æ—à–∏–±–∫—É' (–¥–ª—è –∫–æ–¥–∞)\n",
            parse_mode='Markdown'
        )
```

### –®–∞–≥ 6: –û–±–Ω–æ–≤–∏—Ç—å main.py (10 –º–∏–Ω—É—Ç)

–í `main.py`:

1. **–ò–º–ø–æ—Ä—Ç—ã** (–¥–æ–±–∞–≤—å –≤ –Ω–∞—á–∞–ª–æ):
```python
from services.vision_service import VisionService
from handlers.image_handler import ImageHandler
```

2. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è** (–≤ `__init__` –∫–ª–∞—Å—Å–∞ `TelegramBot`):
```python
def __init__(self):
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ ...
    
    # –î–æ–±–∞–≤–ª—è–µ–º Vision —Å–µ—Ä–≤–∏—Å
    self.vision = VisionService()
    
    # –î–æ–±–∞–≤–ª—è–µ–º Image handler
    self.image_handler = ImageHandler(self.vision)
```

3. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è handlers** (–≤ `_register_handlers`):
```python
def _register_handlers(self):
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ handlers ...
    
    # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    self.app.add_handler(CommandHandler("ocr", self.image_handler.ocr_command))
    self.app.add_handler(CommandHandler("describe", self.image_handler.describe_command))
    
    # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ñ–æ—Ç–æ (–¥–æ–±–∞–≤—å –ü–ï–†–ï–î –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–º —Ç–µ–∫—Å—Ç–∞)
    from telegram import filters
    self.app.add_handler(
        MessageHandler(
            filters.PHOTO & filters.User(user_id=config.ALLOWED_USER_IDS),
            self.image_handler.handle_photo
        )
    )
```

### –®–∞–≥ 7: –û–±–Ω–æ–≤–∏—Ç—å config.py (2 –º–∏–Ω—É—Ç—ã)

–î–æ–±–∞–≤—å –≤ `config.py`:
```python
# Google Gemini API (–¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
GEMINI_API_KEY = os.getenv("GEMINI_API_KEY")
```

### –®–∞–≥ 8: –û–±–Ω–æ–≤–∏—Ç—å requirements.txt (1 –º–∏–Ω—É—Ç–∞)

–î–æ–±–∞–≤—å –≤ `requirements.txt`:
```txt
google-generativeai==0.3.1
pillow==10.4.0
```

### –®–∞–≥ 9: –û–±–Ω–æ–≤–∏—Ç—å /help (5 –º–∏–Ω—É—Ç)

–í `handlers/utils_handler.py`, –≤ –º–µ—Ç–æ–¥–µ `help_command`, –¥–æ–±–∞–≤—å:
```python
üì∏ **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**
‚Ä¢ –û—Ç–ø—Ä–∞–≤—å —Ñ–æ—Ç–æ - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
‚Ä¢ –§–æ—Ç–æ + "—Ç–µ–∫—Å—Ç" - OCR (—Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞)
‚Ä¢ –§–æ—Ç–æ + "–∫–æ–¥" - –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞
‚Ä¢ /describe - –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
‚Ä¢ /ocr - —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å —Ç–µ–∫—Å—Ç
```

### –®–∞–≥ 10: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (15 –º–∏–Ω—É—Ç)

1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ –±–æ—Ç–∞:
```bash
python main.py
```

2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π:
   - –û—Ç–ø—Ä–∞–≤—å –ª—é–±–æ–µ —Ñ–æ—Ç–æ
   - –û—Ç–ø—Ä–∞–≤—å —Ñ–æ—Ç–æ —Å —Ç–µ–∫—Å—Ç–æ–º –∏ –ø–æ–¥–ø–∏—Å—å—é "—Ç–µ–∫—Å—Ç"
   - –û—Ç–ø—Ä–∞–≤—å —Å–∫—Ä–∏–Ω—à–æ—Ç –∫–æ–¥–∞ —Å –ø–æ–¥–ø–∏—Å—å—é "–∫–æ–¥"
   - –û—Ç–ø—Ä–∞–≤—å —Ñ–æ—Ç–æ —Å –≤–æ–ø—Ä–æ—Å–æ–º "–ß—Ç–æ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ?"

---

## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–°–æ–∑–¥–∞–π —Ñ–∞–π–ª `–†–ê–ë–û–¢–ê_–°_–ò–ó–û–ë–†–ê–ñ–ï–ù–ò–Ø–ú–ò.md`:

```markdown
# üì∏ –†–∞–±–æ—Ç–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏

## –û—Å–Ω–æ–≤—ã

–ü—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤—å —Ñ–æ—Ç–æ –±–æ—Ç—É - –æ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø–∏—à–µ—Ç —á—Ç–æ –Ω–∞ –Ω–µ–º!

## –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

### 1. –û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
```
–¢—ã: [–æ—Ç–ø—Ä–∞–≤–ª—è–µ—à—å —Ñ–æ—Ç–æ]
–ë–æ—Ç: –ù–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω –∑–∞–∫–∞—Ç –Ω–∞–¥ –º–æ—Ä–µ–º...
```

### 2. OCR (—Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞)
```
–¢—ã: [—Ñ–æ—Ç–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞] + –ø–æ–¥–ø–∏—Å—å "—Ç–µ–∫—Å—Ç"
–ë–æ—Ç: üìÑ –†–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç:
     "–î–æ–≥–æ–≤–æ—Ä ‚Ññ12345..."
```

### 3. –ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞
```
–¢—ã: [—Å–∫—Ä–∏–Ω—à–æ—Ç –∫–æ–¥–∞] + –ø–æ–¥–ø–∏—Å—å "–∫–æ–¥"
–ë–æ—Ç: üíª –í–∏–∂—É –æ—à–∏–±–∫—É –≤ —Å—Ç—Ä–æ–∫–µ 5...
```

### 4. –û—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã
```
–¢—ã: [—Ñ–æ—Ç–æ] + "–ß—Ç–æ —ç—Ç–æ –∑–∞ –≥–æ—Ä–æ–¥?"
–ë–æ—Ç: –≠—Ç–æ –ü–∞—Ä–∏–∂, –Ω–∞ —Ñ–æ—Ç–æ –≠–π—Ñ–µ–ª–µ–≤–∞ –±–∞—à–Ω—è...
```

## –ö–æ–º–∞–Ω–¥—ã

- `/describe` - —Å–ø—Ä–∞–≤–∫–∞ –ø–æ —Ä–∞–±–æ—Ç–µ —Å —Ñ–æ—Ç–æ
- `/ocr` - —Å–ø—Ä–∞–≤–∫–∞ –ø–æ OCR

## –õ–∏–º–∏—Ç—ã

- –ë–µ—Å–ø–ª–∞—Ç–Ω–æ: 1500 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π/–¥–µ–Ω—å
- –≠—Ç–æ ~50 —Ñ–æ—Ç–æ –≤ –¥–µ–Ω—å - –±–æ–ª–µ–µ —á–µ–º –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ!
```

---

## üéØ –ß—Ç–æ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

–ü–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è:

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑** –≤—Å–µ—Ö —Ñ–æ—Ç–æ
2. **OCR** –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
3. **–ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞** –Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞—Ö
4. **–û—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã** –ø–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º
5. **–û–ø–∏—Å–∞–Ω–∏–µ** –ª—é–±—ã—Ö –∫–∞—Ä—Ç–∏–Ω–æ–∫

---

## üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å

- **–ë–ï–°–ü–õ–ê–¢–ù–û** –¥–æ 1500 –∑–∞–ø—Ä–æ—Å–æ–≤/–¥–µ–Ω—å
- –≠—Ç–æ ~50 —Ñ–æ—Ç–æ –≤ –¥–µ–Ω—å
- –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ - $0.075 / 1M —Ç–æ–∫–µ–Ω–æ–≤ (–æ—á–µ–Ω—å –¥–µ—à–µ–≤–æ)

---

## üêõ –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### API –∫–ª—é—á –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
```bash
# –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –∫–ª—é—á –ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω –≤ .env
cat .env | grep GEMINI_API_KEY

# –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Ñ–∞–π–ª –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
python -c "from dotenv import load_dotenv; import os; load_dotenv(); print(os.getenv('GEMINI_API_KEY'))"
```

### –û—à–∏–±–∫–∞ "quota exceeded"
- –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç 1500/–¥–µ–Ω—å
- –ü–æ–¥–æ–∂–¥–∏ –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –¥–Ω—è
- –ò–ª–∏ –ø–µ—Ä–µ–π–¥–∏ –Ω–∞ –ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω

### –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å —Ä–∞–∑–º–µ—Ä (–º–∞–∫—Å 20MB)
- –ü—Ä–æ–≤–µ—Ä—å —Ñ–æ—Ä–º–∞—Ç (JPG, PNG, GIF, WebP)
- –ü–æ—Å–º–æ—Ç—Ä–∏ –ª–æ–≥–∏ –±–æ—Ç–∞

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∑–∞–º–µ—Ç–∫–∞–º–∏
–ü–æ—Å–ª–µ OCR –ø—Ä–µ–¥–ª–∞–≥–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—Å—Ç:
```python
# –í image_handler.py, –ø–æ—Å–ª–µ OCR:
await update.message.reply_text(
    f"üìÑ –†–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç:\n\n{result}\n\n‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ –∑–∞–º–µ—Ç–∫—É?",
    reply_markup=InlineKeyboardMarkup([[
        InlineKeyboardButton("‚úÖ –î–∞", callback_data=f"save_note:{result[:100]}"),
        InlineKeyboardButton("‚ùå –ù–µ—Ç", callback_data="cancel")
    ]])
)
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–∞–º—è—Ç—å—é
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å —Ñ–∞–∫—Ç—ã –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:
```python
# –ü–æ—Å–ª–µ OCR, –µ—Å–ª–∏ —ç—Ç–æ –¥–æ–∫—É–º–µ–Ω—Ç:
facts = await ai.extract_json(
    text=ocr_result,
    schema_description="{key: string, value: string}[]"
)

for fact in facts:
    await memory.remember_fact(user_id, "documents", fact['key'], fact['value'])
```

### –ê–Ω–∞–ª–∏–∑ –≥—Ä–∞—Ñ–∏–∫–æ–≤
–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤:
```python
if caption and '–≥—Ä–∞—Ñ–∏–∫' in caption.lower():
    prompt = """–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –≥—Ä–∞—Ñ–∏–∫:
    1. –ö–∞–∫–æ–π —Ç–∏–ø –≥—Ä–∞—Ñ–∏–∫–∞?
    2. –ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç?
    3. –ö–∞–∫–æ–π —Ç—Ä–µ–Ω–¥?
    4. –ï—Å—Ç—å –ª–∏ –∞–Ω–æ–º–∞–ª–∏–∏?
    5. –í—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏"""
```

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

- [ ] –ü–æ–ª—É—á–∏–ª API –∫–ª—é—á Gemini
- [ ] –î–æ–±–∞–≤–∏–ª –≤ .env
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∏–ª –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- [ ] –°–æ–∑–¥–∞–ª vision_service.py
- [ ] –°–æ–∑–¥–∞–ª image_handler.py
- [ ] –û–±–Ω–æ–≤–∏–ª main.py
- [ ] –û–±–Ω–æ–≤–∏–ª config.py
- [ ] –û–±–Ω–æ–≤–∏–ª requirements.txt
- [ ] –û–±–Ω–æ–≤–∏–ª help
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª –≤—Å–µ —Ä–µ–∂–∏–º—ã
- [ ] –°–æ–∑–¥–∞–ª –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

---

**–í—Ä–µ–º—è: ~1-2 —á–∞—Å–∞**  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å: –õ–µ–≥–∫–æ** üü¢  
**–†–µ–∑—É–ª—å—Ç–∞—Ç: –ú–æ—â–Ω–∞—è –Ω–æ–≤–∞—è —Ñ–∏—á–∞!** üî•

**–ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å —Å –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ–º?** –ü—Ä–æ—Å—Ç–æ —Å–∫–∞–∂–∏! üöÄ

üá∫üá¶ –°–ª–∞–≤–∞ –£–∫—Ä–∞—ó–Ω—ñ!
```

---

–û—Ç–ª–∏—á–Ω–æ! –°–æ–∑–¥–∞–ª –ø–æ–ª–Ω—ã–π –ø–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. 

**–ß—Ç–æ —è —Å–¥–µ–ª–∞–ª:**

1. üìù **–ê–ù–ê–õ–ò–ó_–ü–†–û–ï–ö–¢–ê.md** - –ø–æ–ª–Ω—ã–π –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ (9/10 –±–∞–ª–ª–æ–≤!)
2. üìù **–ö–†–ê–¢–ö–ò–ô_–ê–ù–ê–õ–ò–ó.md** - –∫—Ä–∞—Ç–∫–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
3. üí° **–ò–ù–¢–ï–†–ï–°–ù–´–ï_–§–£–ù–ö–¶–ò–ò.md** - 10+ –∫—Ä—É—Ç—ã—Ö –∏–¥–µ–π —á—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å
4. üì∏ **–ü–õ–ê–ù_–î–û–ë–ê–í–õ–ï–ù–ò–Ø_–ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ô.md** - –ø–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è Gemini

**–û—Å–Ω–æ–≤–Ω—ã–µ –≤—ã–≤–æ–¥—ã:**

‚úÖ **–ß—Ç–æ –µ—Å—Ç—å (–æ—Ç–ª–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ):**
- 32+ —Ñ—É–Ω–∫—Ü–∏–∏
- DeepSeek + Reasoning + Function Calling
- –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è –ø–∞–º—è—Ç—å
- –ü–∞—Ä—Å–∏–Ω–≥ —Å–∞–π—Ç–æ–≤
- –û—Ç–ª–∏—á–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

‚è≥ **–ß—Ç–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å (—Ç–æ–ø-5):**
1. üì∏ **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è** (Google Gemini) - –ë–ï–°–ü–õ–ê–¢–ù–û!
2. ü§ñ **AI –ê–≥–µ–Ω—Ç** - –ø—Ä–æ–∞–∫—Ç–∏–≤–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
3. üìä **–ì—Ä–∞—Ñ–∏–∫–∏** - –∫—Ä–∞—Å–∏–≤–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
4. üé® **Inline –∫–Ω–æ–ø–∫–∏** - –ª—É—á—à–∏–π UX
5. üîß **–ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–∞—Ä—Å–µ—Ä–∞** - –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã

üí∞ **–°—Ç–æ–∏–º–æ—Å—Ç—å:**
- –°–µ–π—á–∞—Å: ~$1-2/–º–µ—Å—è—Ü (DeepSeek)
- –° –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏: ~$1/–º–µ—Å—è—Ü (Gemini –±–µ—Å–ø–ª–∞—Ç–Ω–æ!)
- –í 200 —Ä–∞–∑ –¥–µ—à–µ–≤–ª–µ —á–µ–º GPT-4!

**–•–æ—á–µ—à—å —á—Ç–æ–±—ã —è –ø–æ–º–æ–≥ –≤–Ω–µ–¥—Ä–∏—Ç—å —á—Ç–æ-—Ç–æ –∏–∑ —ç—Ç–æ–≥–æ?** üöÄ

–ú–æ–≥—É:
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (1-2 —á–∞—Å–∞)
- ‚úÖ –°–æ–∑–¥–∞—Ç—å AI –∞–≥–µ–Ω—Ç–∞ (3-4 —á–∞—Å–∞)
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ (2-3 —á–∞—Å–∞)
- ‚úÖ –í–Ω–µ–¥—Ä–∏—Ç—å inline –∫–Ω–æ–ø–∫–∏ (2-3 —á–∞—Å–∞)
- ‚úÖ –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä—Å–µ—Ä (1-2 —á–∞—Å–∞)

–ü—Ä–æ—Å—Ç–æ —Å–∫–∞–∂–∏ —á—Ç–æ –Ω—É–∂–Ω–æ –ø–µ—Ä–≤—ã–º –¥–µ–ª–æ–º! üòä
